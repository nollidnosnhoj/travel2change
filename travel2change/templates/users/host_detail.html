{% extends "base.html" %}{% load humanize thumbnail sekizai_tags cache staticfiles %}
{% block title %}{{ host.name }}{% endblock title %}
{% block styles %}
<link rel="stylesheet" href="{% static 'css/users/profile.css' %}">
<link rel="stylesheet" href="{% static 'css/star-ratings/star-rating.min.css' %}" media="all" type="text/css" />
<link rel="stylesheet" href="{% static 'css/star-ratings/krajee-fas/theme.css' %}" media="all" type="text/css" />
{% endblock styles %}
{% block jumbo %}
<div class="jumbotron jumbotron-fluid">
    <div class="container">
        <h1 class="display-4">{{ host.name }}</h1>
    </div>
</div>
{% endblock jumbo %}
{% block content %}
<article class="single-activity">
    <ul class="nav nav-pills mb-3" id="profile-tabs" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="true">Profile</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="activities-tab" data-toggle="tab" href="#activities" role="tab" aria-controls="activities" aria-selected="false">Activities</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" id="reviews-tab" data-toggle="tab" href="#reviews" role="tab" aria-controls="reviews" aria-selected="false">Reviews</a>
        </li>
        {% if request.user == host.user %}
        <li class="nav-item">
            <a class="nav-link" href="{% url 'host_update' %}">Edit Profile</a>
        </li>
        {% endif %}
    </ul>
    <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
            {% if host.description %}
                <p>{{ host.description }}</p>
            {% endif %}
            <table class="table table-hover table-responsive-lg">
                <tbody>
                    <tr>
                        <th scope="row">Contact Email:</th>
                        <td>{% if host.contact_email %}{{ host.contact_email }}{% else %}N/A{% endif %}</td>
                    </tr>
                    <tr>
                        <th scope="row">Phone Number:</th>
                        <td>{% if host.phone %}{{ host.phone }}{% else %}N/A{% endif %}</td>
                    </tr>
                    <tr>
                        <th scope="row">Website</th>
                        <td>{% if host.website %}{{ host.website }}{% else %}N/A{% endif %}</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="tab-pane fade" id="activities" role="tabpanel" aria-labelledby="activities-tab">
            <div class="row">
                {% for activity in activities %}
                <div class="col-md-4">
                    <div class="card">
                        {% if activity.featured_photo %}
                        <img src="{{ activity.featured_photo.url }}" class="card-img-top" alt="{{ activity.title }}">
                        {% endif %}
                        <div class="card-body">
                            <h5 class="card-title">
                                <a href="{{ activity.get_absolute_url }}">
                                    {{ activity.title }}
                                </a>
                            </h5>
                            <h6 class="card-subtitle mb-2 text-muted">{{ activity.region }}</h6>
                            <p class="card-text">{{ activity.description|truncatechars:100 }}</p>
                            {% for tag in activity.tags.all %}
                            <a href="#" class="card-link">{{ tag.name }}</a>
                            {% endfor %}
                        </div>
                        <div class="card-footer">
                            <small class="text-muted">
                                Created by {{ activity.approved_time }}
                            </small>
                        </div>
                    </div>
                </div>
                {% if forloop.counter|divisibleby:"3" and not forloop.last %}
                    </div><br />
                    <div class="row">
                {% endif %}
                {% empty %}
                    <p>Host have not created an activity yet.</p>
                {% endfor %}
            </div>
            <p class="text-center mt-2">
                <a href="{% url 'host_activities' host.slug %}">Show More Activities</a>
            </p>
        </div>
        <div class="tab-pane fade" id="reviews" role="tabpanel" aria-labelledby="reviews-tab">
            {% if reviews %}
            {% for review in reviews %}
            <div class="card">
                <div class="card-header clearfix">
                    <div class="float-left">
                        {% if review.show_name %}
                            {{ review.user.full_name }}
                        {% else %}
                            Traveler#{{ review.pk }}
                        {% endif %}
                    </div>
                    <div class="float-right">
                        {% if request.user == host.user and review.show_email %}
                            {{ review.user.email }}
                        {% endif %}
                    </div>
                </div>
                <div class="card-body">
                    <h5 class="card-title">
                        Activity: <a
                            href="{% url 'activities:detail' review.activity.region.slug review.activity.slug review.activity.pk %}"
                            alt="{{ review.activity.title }}">
                            {{ review.activity.title }}
                        </a>
                    </h5>
                    <p class="card-text">{{ review.content }}</p>
                </div>
                <div class="card-footer text-muted clearfix">
                    <div class="float-left">{{ review.created|naturaltime }}</div>
                    <div class="float-right">
                        <input class="rating" type="number" value="{{ review.rating }}" data-size="xs" />
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <p>No one hasn't reviewed any of {{ host.name }} activities yet.</p>
            {% endif %}
            <p class="text-center mt-2">
                <a href="{% url 'host_reviews' host.slug %}">Show More Reviews</a>
            </p>
        </div>
    </div>
</article>
{% endblock content %}
{% block scripts %}
<script src="{% static 'js/star-ratings/star-rating.js' %}" type="text/javascript"></script>
<script src="{% static 'css/star-ratings/krajee-fas/theme.js' %}" type="text/javascript"></script>
<script src="{% static 'js/star-ratings/star-rating-custom.js' %}" type="text/javascript"></script>
<script>
    $(function () {
        var hash = window.location.hash;
        hash && $('ul.nav a[href="' + hash + '"]').tab('show');

        $('#profile-tabs a').click(function (e) {
            $(this).tab('show');
            var scrollmem = $('body').scrollTop() || $('html').scrollTop();
            window.location.hash = this.hash;
            $('html,body').scrollTop(scrollmem);
        });
    });
</script>
{% endblock scripts %}
