## Configuration Website

*Before you proceed:* Please make sure that the database has been migrated, and the server is up and running. 

This section will take you through configuring the website. First thing we need to do is execute some initial scripts. These scripts will create crucial data that will jumpstart this website.

**HOWEVER**, before we run scripts, we need to create a super user so someone can access the website. Through the command-line, enter:

`manage.py createsuperuser --settings=config.settings.production` 

From there, it will take you through the signup form.

### Initial Scripts

- `create_init_data.py` - This script will update the site information (SITE_NAME and SITE_DOMAIN). This script will also create some regions, categories, and tags, based on the previous travel2change website.

To run this initial scripts: enter

`manage.py create_init_data.py --settings=config.settings.production` 

Again, this will generate all the categories, tags, and regions, and update the site name and domain.

- `create_pointvalue.py` - This script will create pointvalue for the points system. This will be discussed later.

To run this script: enter

`manage.py create_pointvalue.py --settings=config.settings.production`  

### Collect Static Files

We need to collect all the static files (css, js, images, etc.).

`python3 manage.py collectstatic --settings=config.settings.production`

When asked to overwrite files, type `yes`.

Once collecting the static files is completed, you need to restart the nginx server.

`~/init/nginx restart` 

### Installing Memcached

Memcached is a distributed memory caching system that often used to speed up dynamic database-driven website, by caching data and objects in RAM. We will need to install this to boost the speed of the website.

You could also refer to this Django Europe Article:

<https://panel.djangoeurope.com/faq/memcache>

First, we need to create an UNIX socket file:

`/usr/bin/memcached -s ~/memcached.sock`

Then navigate to `~/init/` and create a `memcached` file. You could do this in WinSCP.

Inside `memcached` , insert this:

```
#!/bin/bash

# Set this to your memcached port and PID file

PORT=XXXX
IP=127.0.0.1
PIDFILE=~/memcached.pid


# Do not change anything below unless you know what you do

DAEMON=/usr/bin/memcached
NAME="memcached"
PATH=/sbin:/bin:/usr/sbin:/usr/bin
OPTS="-s ~/memcached.sock -d -P $PIDFILE"
#OPTS="-l $IP -p $PORT -d -P $PIDFILE" # Uncomment this line that memcache lists on a TCP port

fail () {
    echo "failed!"
    exit 1
}

success () {
    echo "$NAME."
}

case "$1" in
  start)
      echo -n "Starting $NAME: "
      if start-stop-daemon --start --quiet --pidfile $PIDFILE --exec $DAEMON -- $OPTS ; then
        success
      else
        fail
      fi
    ;;
  stop)
      echo -n "Stopping $NAME: "
      if start-stop-daemon --stop --quiet --oknodo --retry 30 --pidfile $PIDFILE --exec $DAEMON ; then
        success
      else
        fail
      fi
    ;;
  reload)
      echo -n "Reloading $NAME configuration: "
      if ! eval "$DAEMON -t $OPTS" > /dev/null 2>&1; then
        eval "$DAEMON -t $OPTS"
        fail
      fi
      if start-stop-daemon --stop --signal 2 --oknodo --retry 30 --quiet --pidfile $PIDFILE --exec $DAEMON; then
        if start-stop-daemon --start --quiet --pidfile $PIDFILE --exec $DAEMON -- $OPTS ; then
          success
        else
          fail
        fi
      else
        fail
      fi
    ;;
  restart)
      $0 stop
      [ -r  $PIDFILE ] && while pidof memcached |\
          grep -q `cat $PIDFILE 2>/dev/null` 2>/dev/null ; do sleep 1; done
      $0 start
    ;;
  *)
      echo "Usage: $0 {start|stop|restart|reload}"
      exit 1
esac
```

In `PORT=XXXX` , replace `XXXX` with the nginx port. You can find it in the Django Europe Control Panel. Select Ports on the sidebar.

![](https://i.imgur.com/4bL8xBM.png)

Save the file. 

Then enter: `chmod +x ~/init/memcached` 

Now we can run memcache by entering:

`~/init/memcached start` 

### Running the Server

Now we have setup everything, we can actually start running the server. In the command-line, enter:

`~/init/project-name restart`

This will restart the server, since it was running the whole time. You can now enter your website by entering your domain, and you should be treated with this:

![](https://i.imgur.com/YbhfQUe.png)

Remember that superuser we created, use that to login.

We have now successfully logged in!

![](https://i.imgur.com/rzZd3ew.png)

Now let's setup some pages, and an application.

### Setting Up Pages

The objective for this section is to create a homepage, and hook our activities application to Django CMS.

To create a homepage, click on **New Page**.

In **Title**, enter `Home` , and then click Create in the bottom right.

![](https://i.imgur.com/QEOu5DY.png)

Once you create the homepage, you will receive a server error. **This is normal**, because we need to create another page that hooks our activities application to Django CMS. And the homepage possesses contents that looks for the activities app.

In your web browser, go to `http://domain.name/en/admin` (Go to the Django admin)

You are now in the Django admin page. Under **Django CMS** click **Pages**.

![](https://i.imgur.com/um2XDPl.png)

You are presented with the Django CMS Page Tree. 

![](https://i.imgur.com/SNnqqLz.png)

As you can see, the Home page we created is actually the homepage, as indicated by the Home icon next to View.

Let's get rid of that nasty server error on the homepage, and create a **New Page**.

For this page, title should be `Activities` . Also make sure the slug is `activities` 

Click **Save and continue editing**.

On the bottom, click **Advanced Settings**

There should be a dropdown menu called **Application**. Choose `Activity Apphook`. 

A new field called `Application Instance Name` should appear, but just leave it as is `activities`. 

![](https://i.imgur.com/Q4gyNv2.png)

Click **Save**

Now we need to publish the Activities page. 

In the **Page Tree**, on the **Activities** Row, **EN** column, click the **gray circle**, and then click **Publish**.

![](https://i.imgur.com/pNyRaup.png)

We have successfully publish the activities page, but we are not done yet. We need to reset the server. Now, Django CMS states that it does it automatically, but we like to make sure.

In your command-line, enter:

`~/init/project-name restart` 

Go back to the website, and you are now greeted with a nice homepage with a nice search bar.

![](https://i.imgur.com/z3Rdd9H.jpg)

